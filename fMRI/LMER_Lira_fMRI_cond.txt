#!/bin/bash 

cd ~/OBIWAN/DERIVATIVES/GLM/AFNI/hedonicreactivity

#-mask /home/OBIWAN/DERIVATIVES/EXTERNALDATA/LABELS/GM/maskGM.nii \
#run 3dlme in afni
3dLME  -prefix lme_cond -jobs 20 \
-model "condition*session*lik+gender+age+bmi_diff+BMI_t1+GLP1+Fast_glu+thirsty+hungry+piss+condition*fam+condition*int" \
-resid  residuals_cond.nii \
-mask mask.nii \
-qVars 'lik,age,bmi_diff,BMI_t1,GLP1,Fast_glu,thirsty,hungry,piss,fam,int' \
-qVarsCenters '0,0,0,0,0,0,0,0,0,0,0' \
-ranEff '~1|Subj' \
-SS_type 3 \
-num_glt 7 \
-gltLabel 1 'Taste-NoTaste' -gltCode 1 'condition : 1*Reward -1*Neutral'  \
-gltLabel 2 'CondXLik' -gltCode 2 'condition : 1*Reward -1*Neutral lik :'  \
-gltLabel 3 'CondXInt' -gltCode 3 'condition : 1*Reward -1*Neutral int :'  \
-gltLabel 4 'CondXFam' -gltCode 4 'condition : 1*Reward -1*Neutral fam :'  \
-gltLabel 5 'GLP1' -gltCode 5 'GLP1 :'  \
-gltLabel 6 'Fasting_glucose' -gltCode 6 'Fast_glu :'  \
-gltLabel 7 'session' -gltCode 7 'session : 1*1 -1*0'  \
-dataTable @HED_LME_nocov.txt\


#AFNItoNIFTI -prefix test lme+tlrc[5]
for i in 22 30 32 34
do
/usr/local/abin/3dAFNItoNIFTI -prefix lme_cond_con${i} lme_cond+tlrc[${i}]
done

++ Smallest FDR q [0 (Intercept)  F] = 1.62341e-14
++ Smallest FDR q [1 condition  F] = 0.000231921
++ Smallest FDR q [2 time  F] = 0.011967
*+ WARNING: Smallest FDR q [3 intervention  F] = 0.242091 ==> few true single voxel detections
*+ WARNING: Smallest FDR q [4 bmiZ  F] = 0.982333 ==> few true single voxel detections
*+ WARNING: Smallest FDR q [5 gender  F] = 0.974395 ==> few true single voxel detections
++ Smallest FDR q [6 ageZ  F] = 0.00465841
*+ WARNING: Smallest FDR q [7 condition:time  F] = 0.239361 ==> few true single voxel detections
*+ WARNING: Smallest FDR q [8 condition:intervention  F] = 0.986481 ==> few true single voxel detections
++ Smallest FDR q [9 time:intervention  F] = 0.000313954
*+ WARNING: Smallest FDR q [10 condition:bmiZ  F] = 0.987223 ==> few true single voxel detections
++ Smallest FDR q [11 time:bmiZ  F] = 0.0176915
*+ WARNING: Smallest FDR q [12 intervention:bmiZ  F] = 0.57236 ==> few true single voxel detections
*+ WARNING: Smallest FDR q [13 condition:time:intervention  F] = 0.808861 ==> few true single voxel detections
*+ WARNING: Smallest FDR q [14 condition:time:bmiZ  F] = 0.987954 ==> few true single voxel detections
*+ WARNING: Smallest FDR q [15 condition:intervention:bmiZ  F] = 0.976662 ==> few true single voxel detections
++ Smallest FDR q [16 time:intervention:bmiZ  F] = 0.000107513
*+ WARNING: Smallest FDR q [17 condition:time:intervention:bmiZ  F] = 0.987439 ==> few true single voxel detections
++ Smallest FDR q [19 Reward-Neutral Z] = 2.7391e-05

#get ddf
3dinfo -verbose lme_full+tlrc[16]